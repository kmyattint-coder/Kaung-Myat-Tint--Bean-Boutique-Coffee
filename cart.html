<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0" >
    <title>Shopping Cart - Bean Boutique</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
</head>
<body>

    <header>
        <div class="logo">
            <img src="image/logo8.png" alt="Bean Boutique Logo">
            <span>Bean Boutique</span>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="coffee.html">Coffee Selection</a></li>
                <li><a href="brewing.html">Brewing Equipment</a></li>
                <li><a href="cart.html" class="active">Cart</a></li>
                <li><a href="event.html">Events & Workshops</a></li>
                <li><a href="offers.html">Special Offers</a></li>
                <li><a href="profile.html">Profile</a></li>
            </ul>
        </nav>
        <!-- Authentication Buttons -->
        <div class="auth-buttons" id="authButtons">
            <button class="auth-btn login-btn" onclick="openLoginModal()">Login</button>
            <button class="auth-btn signup-btn" onclick="openSignupModal()">Sign Up</button>
        </div>

        <!-- User Info (hidden by default) -->
        <div class="user-info hidden" id="userInfo">
            <span id="welcomeMessage">Welcome, User!</span>
            <button class="logout-btn" onclick="logout()">Logout</button>
        </div>

        <div class="menu-toggle" onclick="document.querySelector('nav ul').classList.toggle('active')">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>

    <!-- Site Announcements Ticker -->
    <div class="site-ticker" role="region" aria-label="Site announcements">
      <div class="ticker-inner">
        <div class="ticker-content">
          <span class="ticker-seq">üõí Review your selections and update quantities anytime. | üîí Secure checkout ‚Äî fast and simple.  </span>
          <span class="ticker-seq">üõí Review your selections and update quantities anytime. | üîí Secure checkout ‚Äî fast and simple.  </span>
        </div>
      </div>
    </div>

    <main>
        <section class="shopping-cart">
            <h2>Your Shopping Cart <i class="fa-solid fa-cart-shopping" aria-hidden="true"></i></h2>
            
            <div class="cart-items" id="cartItems">
                <!-- Items will be rendered here from localStorage -->
            </div>
            
            <div class="cart-summary">
                <h3>Order Summary</h3>
                <div class="summary-line">
                    <p>Subtotal:</p>
                    <p id="subtotal">$0.00</p>
                </div>
                <div class="summary-line">
                    <p>Shipping:</p>
                    <p>Calculated at checkout</p>
                </div>
                <div class="summary-line total">
                    <h4>Total:</h4>
                    <h4 id="total">$0.00</h4>
                </div>
                <button class="checkout-btn">Proceed to Checkout</button>
            </div>
            
        </section>
    </main>

    <!-- ===== Ultra-Modern Footer ===== -->
  <footer class="modern-footer">
    <div class="footer-container">
     
      <!-- Contact Info -->
      <div class="footer-section">
        <h3>Contact Us</h3>
        <p>üìç Bean Boutique, Yangon, Myanmar</p>
        <p>üìû +95 123 456 789</p>
        <p>üìß hello@beanboutique.com</p>
        <div class="social-icons">
          <a href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
          <a href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
          <a href="#" aria-label="Twitter"><i class="fa-brands fa-twitter"></i></a>
        </div>
      </div>

      <!-- Interactive Map -->
      <div class="footer-section">
        <h3>Find Us</h3>
        <div class="map-container">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3826.062!2d96.1951!3d16.8661!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x30c193f4e6e4e6b3%3A0x4d9b7a8b5c6d9e0f!2sYangon%2C%20Myanmar!5e0!3m2!1sen!2smm!4v1691234567890!5m2!1sen!2smm"
            height="200"
            style="border:0; border-radius: 10px;"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade">
          </iframe>
        </div>
      </div>

      <!-- Newsletter Signup -->
      <div class="footer-section">
        <h3>Stay Updated</h3>
        <p>Join our newsletter for fresh brews and exclusive deals!</p>
        <form class="newsletter-form">
          <label for="newsletterEmailCart" class="visually-hidden">Email address</label>
          <input type="email" id="newsletterEmailCart" placeholder="Your Email" required>
          <button type="submit">Subscribe</button>
        </form>
      </div>
    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 Bean Boutique. All rights reserved. Made with ‚ù§Ô∏è for coffee lovers.</p>
    </div>
  </footer>


    <!-- ===== Checkout Modal ===== -->
    <div class="auth-modal" id="checkoutModal">
        <div class="auth-modal-content">
            <button class="auth-close-btn" onclick="closeCheckoutModal()">‚úñ</button>
            <h2>Checkout</h2>
            <form id="checkoutForm" class="auth-form">
                <h3>Shipping Details</h3>
                <label for="shipName" class="visually-hidden">Full name</label>
                <input type="text" id="shipName" placeholder="Full Name" required>
                <label for="shipAddress" class="visually-hidden">Address</label>
                <input type="text" id="shipAddress" placeholder="Address" required>
                <label for="shipCity" class="visually-hidden">City</label>
                <input type="text" id="shipCity" placeholder="City" required>
                <label for="shipZip" class="visually-hidden">Postal or ZIP code</label>
                <input type="text" id="shipZip" placeholder="Postal / ZIP Code" required>

                <h3>Payment</h3>
                <label for="cardNumber" class="visually-hidden">Card number</label>
                <input type="text" id="cardNumber" placeholder="Card Number" required>
                <div>
                    <label for="cardExpiry" class="visually-hidden">Expiry date (MM/YY)</label>
                    <input type="text" id="cardExpiry" placeholder="MM/YY" required>
                </div>
                <label for="cardCVC" class="visually-hidden">CVC</label>
                <input type="text" id="cardCVC" placeholder="CVC" required>

                <button type="submit">Submit Order</button>
            </form>
        </div>
    </div>

    <!-- ===== Order Confirmed Modal ===== -->
    <div class="auth-modal" id="orderConfirmModal">
        <div class="auth-modal-content">
            <button class="auth-close-btn" onclick="closeOrderConfirmModal()">‚úñ</button>
            <h2>Order Confirmed</h2>
            <p>Thank you for your purchase! Your order has been placed successfully.</p>
            <div class="auth-form">
                <button type="button" onclick="closeOrderConfirmModal()">Continue Shopping</button>
            </div>
        </div>
    </div>

    <!-- ===== Login Modal ===== -->
    <div class="auth-modal" id="loginModal">
        <div class="auth-modal-content">
            <button class="auth-close-btn" onclick="closeAuthModal('loginModal')">‚úñ</button>
            <h2>Welcome Back!</h2>
            <form class="auth-form" onsubmit="handleLogin(event)">
                <label for="loginEmail" class="visually-hidden">Email address</label>
                <input type="email" id="loginEmail" placeholder="Email Address" required>
                <label for="loginPassword" class="visually-hidden">Password</label>
                <input type="password" id="loginPassword" placeholder="Password" required>
                <label class="robot-check"><input type="checkbox" id="loginRobot"> I'm not a robot</label>
                <button type="submit">Login</button>
            </form>
            <div class="social-auth">
                <div class="or">or</div>
                <button class="social-btn google-btn" onclick="socialLogin('google')">Continue with Google</button>
                <button class="social-btn facebook-btn" onclick="socialLogin('facebook')">Continue with Facebook</button>
            </div>
            <div class="auth-switch">
                Don't have an account? <a href="#" onclick="switchToSignup()">Sign up here</a>
            </div>
        </div>
    </div>

    <!-- ===== Signup Modal ===== -->
    <div class="auth-modal" id="signupModal">
        <div class="auth-modal-content">
            <button class="auth-close-btn" onclick="closeAuthModal('signupModal')">‚úñ</button>
            <h2>Join Bean Boutique!</h2>
            <form class="auth-form" onsubmit="handleSignup(event)">
                <label for="signupName" class="visually-hidden">Full name</label>
                <input type="text" id="signupName" placeholder="Full Name" required>
                <label for="signupEmail" class="visually-hidden">Email address</label>
                <input type="email" id="signupEmail" placeholder="Email Address" required>
                <label for="signupPassword" class="visually-hidden">Password</label>
                <input type="password" id="signupPassword" placeholder="Password" required>
                <label for="signupConfirmPassword" class="visually-hidden">Confirm password</label>
                <input type="password" id="signupConfirmPassword" placeholder="Confirm Password" required>
                <label class="robot-check"><input type="checkbox" id="signupRobot"> I'm not a robot</label>
                <button type="submit">Sign Up</button>
            </form>
            <div class="social-auth">
                <div class="or">or</div>
                <button class="social-btn google-btn" onclick="socialSignup('google')">Sign up with Google</button>
                <button class="social-btn facebook-btn" onclick="socialSignup('facebook')">Sign up with Facebook</button>
            </div>
            <div class="auth-switch">
                Already have an account? <a href="#" onclick="switchToLogin()">Login here</a>
            </div>
        </div>
    </div>

    <script>
        // Check authentication status on page load
        document.addEventListener('DOMContentLoaded', function(){
            checkAuthStatus();
        });
        window.addEventListener('load', function(){
            checkAuthStatus();
        });

        // Authentication Functions
        function checkAuthStatus() {
            const currentUser = localStorage.getItem('currentUser');
            const authButtons = document.getElementById('authButtons');
            const userInfo = document.getElementById('userInfo');
            const welcomeMessage = document.getElementById('welcomeMessage');

            if (currentUser) {
                const userData = JSON.parse(currentUser);
                authButtons.classList.add('hidden');
                userInfo.classList.remove('hidden');
                welcomeMessage.textContent = `Welcome, ${userData.name}!`;
            } else {
                authButtons.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
            // Reveal auth UI after state is applied (prevents flicker)
            document.body.classList.add('auth-state-applied');
        }

        // --- Social auth simulators (no backend) ---
        function socialUserFromProvider(provider){
            const name = provider === 'google' ? 'Google User' : 'Facebook User';
            const email = provider + '_user@example.com';
            return { name, email, password: provider + '_oauth' };
        }
        function ensureRegistered(user){
            const users = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            if (!users.find(u => (u.email||'').toLowerCase() === user.email.toLowerCase())){
                users.push(user);
                localStorage.setItem('registeredUsers', JSON.stringify(users));
            }
        }
        function finishLogin(user){
            localStorage.setItem('currentUser', JSON.stringify(user));
            closeAuthModal('loginModal');
            closeAuthModal('signupModal');
            checkAuthStatus();
            alert('Welcome, ' + user.name + '!');
        }
        function socialLogin(provider){ const user = socialUserFromProvider(provider); ensureRegistered(user); finishLogin(user); }
        function socialSignup(provider){ const user = socialUserFromProvider(provider); ensureRegistered(user); finishLogin(user); }

        function openLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }

        function openSignupModal() {
            document.getElementById('signupModal').classList.add('active');
        }

        function closeAuthModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function switchToSignup() {
            closeAuthModal('loginModal');
            openSignupModal();
        }

        function switchToLogin() {
            closeAuthModal('signupModal');
            openLoginModal();
        }

        function handleLogin(event) {
            event.preventDefault();
            if (!document.getElementById('loginRobot').checked) { alert("Please confirm you're not a robot."); return; }
            
            const email = document.getElementById('loginEmail').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            
            const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            const user = registeredUsers.find(u => (u.email || '').toLowerCase() === email && u.password === password);
            
            if (user) {
                localStorage.setItem('currentUser', JSON.stringify(user));
                closeAuthModal('loginModal');
                checkAuthStatus();
                alert('Login successful! Welcome back, ' + user.name + '!');
            } else {
                alert('Invalid email or password. Please try again.');
            }
        }

        function handleSignup(event) {
            event.preventDefault();
            if (!document.getElementById('signupRobot').checked) { alert("Please confirm you're not a robot."); return; }
            
            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim().toLowerCase();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupConfirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match!');
                return;
            }
            
            if (password.length < 6) {
                alert('Password must be at least 6 characters long!');
                return;
            }
            
            const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '[]');
            
            if (registeredUsers.find(u => (u.email || '').toLowerCase() === email)) {
                alert('An account with this email already exists!');
                return;
            }
            
            const newUser = { name, email, password };
            registeredUsers.push(newUser);
            
            localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
            localStorage.setItem('currentUser', JSON.stringify(newUser));
            
            closeAuthModal('signupModal');
            checkAuthStatus();
            alert('Account created successfully! Welcome to Bean Boutique, ' + name + '!');
        }

        function logout() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('cart');
            checkAuthStatus();
            alert('You have been logged out successfully!');
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const loginModal = document.getElementById('loginModal');
            const signupModal = document.getElementById('signupModal');
            
            if (event.target === loginModal) {
                closeAuthModal('loginModal');
            }
            if (event.target === signupModal) {
                closeAuthModal('signupModal');
            }
        }

        // Close modals on Escape key
        document.addEventListener('keydown', function(e){
            if (e.key === 'Escape' || e.key === 'Esc') {
                const loginModal = document.getElementById('loginModal');
                const signupModal = document.getElementById('signupModal');
                const checkoutModal = document.getElementById('checkoutModal');
                const orderConfirmModal = document.getElementById('orderConfirmModal');
                if (loginModal && loginModal.classList.contains('active')) closeAuthModal('loginModal');
                if (signupModal && signupModal.classList.contains('active')) closeAuthModal('signupModal');
                if (checkoutModal && checkoutModal.classList.contains('active')) closeCheckoutModal();
                if (orderConfirmModal && orderConfirmModal.classList.contains('active')) closeOrderConfirmModal();
            }
        });

        // --- Cart Helpers ---
        function getCart() {
            try { return JSON.parse(localStorage.getItem('cart') || '[]'); } catch { return []; }
        }
        function saveCart(cart) {
            localStorage.setItem('cart', JSON.stringify(cart));
        }

        // Provide basic prices for known items
        const priceCatalog = {
            'House Blend': 12.99,
            'Ethiopian Single-Origin': 14.99,
            'Espresso Roast': 13.99,
            'Espresso Machine': 349.0,
            'French Press': 49.99,
            'Pour Over Kit': 29.99
        };

        function renderCart() {
            const container = document.getElementById('cartItems');
            container.innerHTML = '';
            const currentUser = localStorage.getItem('currentUser');
            const checkoutBtn = document.querySelector('.checkout-btn');
            if (!currentUser) {
                // Not logged in: prompt user to login/signup instead of showing empty cart
                container.innerHTML = '<p class="cart-login-msg">You haven\'t logged in or signed up yet. Please log in to view your cart.</p>';
                if (checkoutBtn) checkoutBtn.setAttribute('disabled', 'disabled');
                document.getElementById('subtotal').innerText = '$0.00';
                document.getElementById('total').innerText = '$0.00';
                return;
            } else {
                if (checkoutBtn) checkoutBtn.removeAttribute('disabled');
            }
            const cart = getCart();
            if (cart.length === 0) {
                container.innerHTML = '<p>Your cart is empty.</p>';
                updateCartSummary();
                return;
            }

            cart.forEach((item, index) => {
                const price = (typeof item.price === 'number') ? item.price : (priceCatalog[item.name] ?? 0);
                const itemEl = document.createElement('div');
                itemEl.className = 'cart-item';
                const imgSrc = item.image || guessImage(item.name);
                itemEl.innerHTML = `
                    <img src="${imgSrc}" alt="${item.name}" class="item-img">
                    <div class="item-details">
                        <h3>${item.name}</h3>
                        <p class="price">$${price.toFixed(2)}</p>
                        <div class="quantity-control">
                            <button class="quantity-btn minus" data-index="${index}">-</button>
                            <input type="text" value="${item.quantity}" class="item-quantity" readonly>
                            <button class="quantity-btn plus" data-index="${index}">+</button>
                        </div>
                    </div>
                    <button class="remove-btn" data-index="${index}">Remove</button>
                `;
                container.appendChild(itemEl);
            });

            bindCartEvents();
            updateCartSummary();
        }

        function bindCartEvents() {
            document.querySelectorAll('.remove-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const index = parseInt(button.getAttribute('data-index'));
                    const cart = getCart();
                    cart.splice(index, 1);
                    saveCart(cart);
                    renderCart();
                });
            });

            document.querySelectorAll('.quantity-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const index = parseInt(button.getAttribute('data-index'));
                    const cart = getCart();
                    let item = cart[index];
                    if (!item) return;
                    if (button.classList.contains('plus')) {
                        item.quantity += 1;
                    } else if (item.quantity > 1) {
                        item.quantity -= 1;
                    }
                    saveCart(cart);
                    renderCart();
                });
            });
        }

        function updateCartSummary() {
            let subtotal = 0;
            const cart = getCart();
            cart.forEach(item => {
                const price = (typeof item.price === 'number') ? item.price : (priceCatalog[item.name] ?? 0);
                subtotal += price * (item.quantity || 1);
            });
            document.getElementById('subtotal').innerText = `$${subtotal.toFixed(2)}`;
            document.getElementById('total').innerText = `$${subtotal.toFixed(2)}`;
        }

        function guessImage(name) {
            // Very simple mapping to existing images in project
            const map = {
                'Ethiopian Single-Origin': 'image/cofeeeeeee.webp',
                'Espresso Machine': 'image/Profitec-GO-Espresso-Machine_20250418-052952_full.jpeg',
                'French Press': 'image/Espro-P3-French-Press_20250418-042646_full.jpeg',
                'Pour Over Kit': 'image/Kalita-Wave-185-Dripper_20250418-040846_full.jpeg',
                'House Blend': 'image/blend.webp',
                'Espresso Roast': 'image/group.webp'
            };
            return map[name] || 'image/blend.webp';
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderCart();
            // Hook checkout button
            const checkoutBtn = document.querySelector('.checkout-btn');
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', () => {
                    if (getCart().length === 0) {
                        showToast('Your cart is empty');
                        return;
                    }
                    openCheckoutModal();
                });
            }

            // Handle checkout form submit
            const checkoutForm = document.getElementById('checkoutForm');
            if (checkoutForm) {
                checkoutForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    if (getCart().length === 0) {
                        showToast('Your cart is empty');
                        closeCheckoutModal();
                        return;
                    }
                    // Very simple client-side validation already ensured by required attributes
                    // Simulate order submission
                    localStorage.removeItem('cart');
                    renderCart();
                    closeCheckoutModal();
                    openOrderConfirmModal();
                    showToast('‚úÖ Order confirmed!');
                });
            }
        });

        function openCheckoutModal() {
            document.getElementById('checkoutModal').classList.add('active');
        }

        function closeCheckoutModal() {
            document.getElementById('checkoutModal').classList.remove('active');
        }

        function openOrderConfirmModal() {
            document.getElementById('orderConfirmModal').classList.add('active');
        }
        function closeOrderConfirmModal() {
            document.getElementById('orderConfirmModal').classList.remove('active');
        }

        // Generic toast utility for this page
        function showToast(message) {
            let toast = document.getElementById('orderToast');
            if (!toast) {
                toast = document.createElement('div');
                toast.id = 'orderToast';
                toast.className = 'toast';
                document.body.appendChild(toast);
            }
            toast.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
    </script>

<!-- Unified Auth UI Sync -->
<script>
  (function(){
    function bbSyncAuthUI(){
      const current = localStorage.getItem('currentUser');
      const authButtons = document.getElementById('authButtons');
      const userInfo = document.getElementById('userInfo');
      const welcomeMessage = document.getElementById('welcomeMessage');
      let userData = null;
      if (current) { try { userData = JSON.parse(current); } catch(e){} }
      if (userData) {
        if (authButtons) authButtons.classList.add('hidden');
        if (userInfo) userInfo.classList.remove('hidden');
        if (welcomeMessage && userData.name) welcomeMessage.textContent = `Welcome, ${userData.name}!`;
      } else {
        if (authButtons) authButtons.classList.remove('hidden');
        if (userInfo) userInfo.classList.add('hidden');
      }
      document.body.classList.add('auth-state-applied');
    }
    window.bbSyncAuthUI = bbSyncAuthUI;
    window.checkAuthStatus = bbSyncAuthUI;
    document.addEventListener('DOMContentLoaded', bbSyncAuthUI);
    window.addEventListener('load', bbSyncAuthUI);
    window.addEventListener('storage', function(e){
      if (e.key === 'currentUser') bbSyncAuthUI();
    });
  })();
</script>

</body>
</html>